"use strict";(self.webpackChunkmy_react_appo=self.webpackChunkmy_react_appo||[]).push([[412],{9412:(e,t,a)=>{a.r(t),a.d(t,{default:()=>R});var o=a(9950),l=a(3464),n=a(33),r=a(8170),s=a(5308),i=a(9739),c=a(226),d=a(4857),u=a(6589),g=a(6491),m=a(6639),x=a(2053),p=a(5277),h=a(5333),j=a(899),v=a(975),y=a(7324),A=a(9694),f=a(9532),C=a(2578),b=(a(9751),a(6820),a(3849)),S=a(294),w=a(8429),k=a(2845),E=a(2675),D=a(4414);const P=e=>{let{isOpen:t,onClose:a,onConfirm:d}=e;const[u,g]=(0,o.useState)("");return(0,D.jsxs)(l.A,{open:t,onClose:a,children:[(0,D.jsx)(n.A,{children:"Introduzca Descuento"}),(0,D.jsx)(r.A,{children:(0,D.jsx)(s.A,{autoFocus:!0,margin:"dense",label:"Descuento en %",type:"number",fullWidth:!0,value:u,onChange:e=>g(e.target.value)})}),(0,D.jsxs)(i.A,{children:[(0,D.jsx)(c.A,{onClick:a,children:"Cancel"}),(0,D.jsx)(c.A,{onClick:()=>{u<90?d(u):alert("Ha ocurido un error"),a()},color:"primary",children:"Confirm"})]})]})},R=()=>{const[e,t]=(0,o.useState)(""),[a,l]=(0,o.useState)(""),[n,r]=(0,o.useState)(""),[i,R]=(0,o.useState)(""),[T,G]=(0,o.useState)(null),[I,H]=(0,o.useState)(""),[N,J]=(0,o.useState)(!1),[W,B]=(0,o.useState)(""),[F,K]=(0,o.useState)(!1),[z,q]=(0,o.useState)(""),[O,_]=(0,o.useState)([]),[L,U]=(0,o.useState)("Aerea"),[Z,Y]=(0,o.useState)([]),[M,Q]=(0,o.useState)(!0),[V,X]=(0,o.useState)([]),[$,ee]=(0,o.useState)([]),[te,ae]=(0,o.useState)([]),[oe,le]=(0,o.useState)([]),[ne,re]=(0,o.useState)({}),[se,ie]=(0,o.useState)(""),[ce,de]=(0,o.useState)(""),[ue,ge]=(0,o.useState)(""),me=(0,C.C3)(S.A),xe=(0,d.A)(),pe=(0,u.A)(xe.breakpoints.down("sm")),{codigo:he,contexto:je}=(0,w.g)(),[ve,ye]=(0,o.useState)(!1),[Ae,fe]=(0,o.useState)(!1),[Ce,be]=(0,o.useState)(!1),[Se,we]=(0,o.useState)(""),[ke,Ee]=(0,o.useState)(!1),[De,Pe]=(0,o.useState)("color"),[Re,Te]=(0,o.useState)(null),[Ge,Ie]=(0,o.useState)(""),[He,Ne]=(0,o.useState)(""),Je=((0,w.Zp)(),(0,b.aU)(S.A)),We=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var a,o,l;(Pe(e),Te(t),t)?(console.log(t.precio,"hoal"),"talla"===e?(Ie(null!==(a=t.label)&&void 0!==a?a:""),Ne(null!==(o=t.precio)&&void 0!==o?o:0)):(Ie(null!==(l=t.label)&&void 0!==l?l:""),Ne(""))):(Ie(""),Ne(""));Ee(!0)},Be=e=>e<=7e3?1.3*e+1500:e<=25e3?1.22*e+1e3:e<=25e4?1.15*e:e<=5e5?1.12*e:1.08*e+1e5;console.log(he);const[Fe,Ke]=(0,o.useState)(null),ze=()=>{fe(!1)},qe=async e=>{let t=parseInt(e),a="Guinea Ecuatorial"===T.Pais?"Nacional":"Exterior";const o=(0,C.KR)(me,"GE/".concat(a,"/Prod/").concat(he));try{if(console.log(e,"existe"),await(0,C.yo)(o,{Descuento:t}),t>0){(0,C.KR)(me,"GE/Rebajas/".concat(he));const e=(0,C.KR)(me,"GE/Filtros/".concat(a,"/").concat(T.Categoria,"/").concat(he));(0,C.KR)(me,"GE/".concat(a,"/Prod/").concat(he));await(0,C.yo)(e,{Descuento:t})}else{const e=(0,C.KR)(me,"GE/Rebajas/".concat(he)),o=(0,C.KR)(me,"Filtros/".concat(a,"/").concat(T.Categoria,"/").concat(he));await(0,C.yo)(o,{Descuento:t}),await(0,C.TF)(e)}console.log("Data updated successfully")}catch(l){console.error("Error updating data: ",l)}},Oe=async(e,t)=>{fe(!0),we(e),console.log(e,"a elimianr"),Pe(t)};(0,o.useEffect)((()=>((async e=>{try{var a,o,n,r,s;const i=(0,b.H9)(Je,"productos",e),c=await(0,b.x7)(i);if(!c.exists())return console.log("\u274c No existe el documento del producto:",e),G(null),ae([]),void X([]);const d=c.data();G(d),t(null!==(a=d.Titulo)&&void 0!==a?a:""),B(null!==(o=d.Ubicacion)&&void 0!==o?o:""),l(null!==(n=d.Precio)&&void 0!==n?n:""),q(null!==(r=d.Detalles)&&void 0!==r?r:""),J(null!==(s=d.Stock)&&void 0!==s?s:""),console.log("Producto Data:",d);const u=(0,b.rJ)(Je,"productos",e,"colores"),g=(0,b.rJ)(Je,"productos",e,"tallas"),[m,x]=await Promise.all([(0,b.GG)(u),(0,b.GG)(g)]),p=m.docs.map((e=>e.data())),h=x.docs.map((e=>e.data()));console.log("Colores:",p),X(p||[]),ae(h||[])}catch(i){console.error("\u274c Error al obtener datos:",i)}})(he),()=>{})),[]);return(0,D.jsxs)(D.Fragment,{children:[F&&(0,D.jsx)(g.A,{sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",bgcolor:"rgba(0,0,0,0.4)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999},children:(0,D.jsx)(m.A,{size:60,color:"primary"})}),(0,D.jsxs)(g.A,{component:"form",onSubmit:async t=>{t.preventDefault(),K(!0);const o={Titulo:e,Precio:parseInt(Be(a)),Detalles:z},l=(0,b.H9)(Je,"productos",he);try{await(0,b.mZ)(l,o),alert("Producto modificado correctamente!"),K(!1),console.log("Producto actualizado correctamente.")}catch(n){K(!1),alert("ERROR INESPERADO: "+n.message),console.error("Error al actualizar el producto:",n)}},sx:{mt:2,padding:2},children:[(0,D.jsx)(k.A,{texto:"Editar"}),(0,D.jsx)("div",{style:{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",marginTop:pe?40:0}}),(0,D.jsxs)("div",{style:{margin:10},children:[(0,D.jsx)(x.A,{variant:"subtitle1",gutterBottom:!0,children:"Colores"}),V.map(((e,t)=>(0,D.jsx)(p.A,{label:e.label,style:{margin:3},onClick:()=>We("color",e),onDelete:()=>Oe(e,"color")},t))),(0,D.jsx)(h.A,{color:"primary",onClick:()=>We("color"),children:(0,D.jsx)(f.A,{})})]}),(0,D.jsxs)("div",{style:{margin:10},children:[(0,D.jsx)(x.A,{variant:"subtitle1",gutterBottom:!0,children:"Tallas"}),te.map(((e,t)=>(0,D.jsx)(p.A,{label:"".concat(e.label," : ").concat(e.precio),style:{margin:3},onClick:()=>We("talla",e),onDelete:()=>Oe(e,"talla")}))),(0,D.jsx)(h.A,{color:"primary",onClick:()=>We("talla"),children:(0,D.jsx)(f.A,{})})]}),(0,D.jsxs)(j.Ay,{container:!0,spacing:2,marginTop:pe?5:0,children:[(0,D.jsx)(j.Ay,{item:!0,xs:12,children:(0,D.jsx)(s.A,{label:"Title",variant:"outlined",value:e,onChange:e=>t(e.target.value),required:!0,fullWidth:!0})}),(0,D.jsx)(j.Ay,{item:!0,xs:12,children:(0,D.jsx)(s.A,{label:"Price",variant:"outlined",type:"number",value:a,onChange:e=>l(e.target.value),required:!0,fullWidth:!0})}),"Nacional"===je&&(0,D.jsxs)(g.A,{display:"flex",alignItems:"flex-end",marginY:1,margin:1,children:[(0,D.jsx)(s.A,{label:"Cantidad",type:"number",value:I,onChange:e=>H(e.target.value),style:{marginLeft:"8px"}}),(0,D.jsx)("div",{style:{margin:10,marginLeft:30},children:(0,D.jsx)(v.A,{control:(0,D.jsx)(y.A,{checked:N,onChange:e=>{J(e.target.checked)}}),label:"Stock"})})]}),(0,D.jsx)(j.Ay,{item:!0,xs:12,children:(0,D.jsx)(s.A,{label:"Details",variant:"outlined",multiline:!0,rows:4,value:z,onChange:e=>q(e.target.value),required:!0,fullWidth:!0})}),(0,D.jsx)("div",{style:{display:"flex",alignContent:"center",alignItems:"center"},children:(0,D.jsx)(c.A,{type:"submit",variant:"contained",color:"primary",children:"PUBLICAR"})})]}),Fe&&(0,D.jsxs)("p",{children:["Entered number: ",Fe]}),(0,D.jsx)(P,{isOpen:ve,onClose:()=>{ye(!1)},onConfirm:e=>{Ke(e),qe(e)}}),(0,D.jsx)(E.A,{open:Ae,message:"Seguro que desea borrar este valor?",onClose:ze,onConfirm:async()=>{try{const e="color"===De,t=e?"colores":"tallas";if(console.log(Se,De),e?X((e=>e.filter((e=>e.id!==Se.id)))):ae((e=>e.filter((e=>e.id!==Se.id)))),console.log(Se.id,"eliminar"),!Se.id)return;const a=(0,b.H9)(Je,"productos",he),o=(0,b.H9)((0,b.rJ)(a,t),Se.id);await(0,b.kd)(o),console.log("\u2705 ".concat(e?"Color":"Talla"," '").concat(Se.label,"' eliminado de Firestore."))}catch(e){console.error("\u274c Error eliminando chip:",e)}ze()}}),(0,D.jsx)(A.Ay,{anchor:"right",open:ke,onClose:()=>Ee(!1),children:(0,D.jsxs)(g.A,{sx:{width:300,padding:2},children:[(0,D.jsx)(x.A,{variant:"h6",gutterBottom:!0,children:"color"===De?"Nuevo Color":"Nueva Talla"}),(0,D.jsx)(s.A,{label:"color"===De?"Color":"Talla",value:Ge,onChange:e=>Ie(e.target.value),fullWidth:!0,margin:"normal"}),"talla"===De&&(0,D.jsx)(s.A,{label:"Precio",type:"number",value:He,onChange:e=>Ne(e.target.value),fullWidth:!0,margin:"normal"}),(0,D.jsx)(c.A,{variant:"contained",color:"primary",onClick:async()=>{if(!Ge)return;const e=(0,b.H9)(Je,"productos",he);if("color"===De)if(Re){X((e=>e.map((e=>e.id===Re.id?{...e,label:Ge}:e))));const t=(0,b.H9)((0,b.rJ)(e,"colores"),Re.id);await(0,b.mZ)(t,{label:Ge}),console.log("Color editado:",Ge)}else{const t=(0,b.H9)((0,b.rJ)(e,"colores")),a={id:t.id,label:Ge};await(0,b.BN)(t,a),X((e=>[...e,a])),console.log("Color nuevo guardado:",a)}else{let t=parseInt(Be(He));const a={label:Ge,precio:t||0};if(Re){ae((e=>e.map((e=>e.id===Re.id?{...e,label:Ge,precio:t}:e))));(0,b.H9)((0,b.rJ)(e,"tallas"),Re.id);console.log("Talla editada:",a)}else{const t=(0,b.H9)((0,b.rJ)(e,"tallas")),o={id:t.id,...a};await(0,b.BN)(t,o),ae((e=>[...e,o])),console.log("Talla nueva guardada:",o)}}Te(null),X([]),ae([]),Ie(""),Ne(""),fe(!1),Ee(!1)},sx:{mt:2},fullWidth:!0,children:"Guardar"})]})})]})]})}}}]);