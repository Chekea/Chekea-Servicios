"use strict";(self.webpackChunkmy_react_appo=self.webpackChunkmy_react_appo||[]).push([[412],{9412:(e,o,t)=>{t.r(o),t.d(o,{default:()=>G});var a=t(9950),l=t(3464),n=t(33),c=t(8170),s=t(5308),r=t(9739),i=t(226),u=t(4857),d=t(6589),g=t(6491),x=t(2053),p=t(5277),h=t(5333),m=t(899),y=t(975),j=t(7324),C=t(6639),f=t(9694),v=t(9532),A=t(2578),b=(t(9751),t(6820),t(3849)),S=t(294),E=t(8429),k=t(2845),w=t(2675),P=t(4414);const R=e=>{let{isOpen:o,onClose:t,onConfirm:u}=e;const[d,g]=(0,a.useState)("");return(0,P.jsxs)(l.A,{open:o,onClose:t,children:[(0,P.jsx)(n.A,{children:"Introduzca Descuento"}),(0,P.jsx)(c.A,{children:(0,P.jsx)(s.A,{autoFocus:!0,margin:"dense",label:"Descuento en %",type:"number",fullWidth:!0,value:d,onChange:e=>g(e.target.value)})}),(0,P.jsxs)(r.A,{children:[(0,P.jsx)(i.A,{onClick:t,children:"Cancel"}),(0,P.jsx)(i.A,{onClick:()=>{d<90?u(d):alert("Ha ocurido un error"),t()},color:"primary",children:"Confirm"})]})]})},G=()=>{const[e,o]=(0,a.useState)(""),[t,l]=(0,a.useState)(""),[n,c]=(0,a.useState)(""),[r,G]=(0,a.useState)(""),[D,T]=(0,a.useState)(null),[K,F]=(0,a.useState)(""),[I,N]=(0,a.useState)(!1),[W,J]=(0,a.useState)(""),[H,O]=(0,a.useState)(!1),[U,q]=(0,a.useState)(""),[B,L]=(0,a.useState)([]),[_,z]=(0,a.useState)("Aerea"),[Z,M]=(0,a.useState)([]),[V,Y]=(0,a.useState)(!0),[Q,X]=(0,a.useState)([]),[$,ee]=(0,a.useState)([]),[oe,te]=(0,a.useState)([]),[ae,le]=(0,a.useState)([]),[ne,ce]=(0,a.useState)({}),[se,re]=(0,a.useState)(""),[ie,ue]=(0,a.useState)(""),[de,ge]=(0,a.useState)(""),xe=(0,A.C3)(S.A),pe=(0,u.A)(),he=(0,d.A)(pe.breakpoints.down("sm")),{codigo:me,contexto:ye}=(0,E.g)(),[je,Ce]=(0,a.useState)(!1),[fe,ve]=(0,a.useState)(!1),[Ae,be]=(0,a.useState)(!1),[Se,Ee]=(0,a.useState)(""),[ke,we]=(0,a.useState)(!1),[Pe,Re]=(0,a.useState)("color"),[Ge,De]=(0,a.useState)(null),[Te,Ke]=(0,a.useState)(""),[Fe,Ie]=(0,a.useState)(""),Ne=((0,E.Zp)(),(0,b.aU)(S.A)),We=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var t,a,l;(Re(e),De(o),o)?"talla"===e?(Ke(null!==(t=o.label)&&void 0!==t?t:""),Ie(null!==(a=o.price)&&void 0!==a?a:0)):(Ke(null!==(l=o.label)&&void 0!==l?l:""),Ie("")):(Ke(""),Ie(""));we(!0)};console.log(me);const[Je,He]=(0,a.useState)(null),Oe=()=>{ve(!1)},Ue=e=>"Guinea Ecuatorial"===e?"Nacional":"Exterior",qe=async e=>{let o=parseInt(e),t=Ue(D.Pais);const a=(0,A.KR)(xe,"GE/".concat(t,"/Prod/").concat(me));try{if(console.log(e,"existe"),await(0,A.yo)(a,{Descuento:o}),o>0){(0,A.KR)(xe,"GE/Rebajas/".concat(me));const e=(0,A.KR)(xe,"GE/Filtros/".concat(t,"/").concat(D.Categoria,"/").concat(me));(0,A.KR)(xe,"GE/".concat(t,"/Prod/").concat(me));await(0,A.yo)(e,{Descuento:o})}else{const e=(0,A.KR)(xe,"GE/Rebajas/".concat(me)),a=(0,A.KR)(xe,"Filtros/".concat(t,"/").concat(D.Categoria,"/").concat(me));await(0,A.yo)(a,{Descuento:o}),await(0,A.TF)(e)}console.log("Data updated successfully")}catch(l){console.error("Error updating data: ",l)}},Be=async(e,o)=>{ve(!0),Ee(e),Re(o)};(0,a.useEffect)((()=>((async e=>{try{var t,a,n,c,s;const r=(0,b.H9)(Ne,"productos",e),i=await(0,b.x7)(r);if(!i.exists())return console.log("\u274c No existe el documento del producto:",e),T(null),te([]),void X([]);const u=i.data();T(u),o(null!==(t=u.Titulo)&&void 0!==t?t:""),J(null!==(a=u.Ubicacion)&&void 0!==a?a:""),l(null!==(n=u.Precio)&&void 0!==n?n:""),q(null!==(c=u.Detalles)&&void 0!==c?c:""),N(null!==(s=u.Stock)&&void 0!==s?s:""),console.log("Producto Data:",u);const d=(0,b.rJ)(Ne,"productos",e,"colores"),g=(0,b.rJ)(Ne,"productos",e,"tallas"),[x,p]=await Promise.all([(0,b.GG)(d),(0,b.GG)(g)]),h=x.docs.map((e=>e.data())),m=p.docs.map((e=>e.data()));console.log("Colores:",h),X(h||[]),te(m||[])}catch(r){console.error("\u274c Error al obtener datos:",r)}})(me),()=>{})),[]);const Le=async(e,o,t)=>{const a=(0,A.P)((0,A.KR)(xe,"GE/".concat(ye,"/Prod/").concat(me,"/").concat(o)),(0,A.kT)("label"),(0,A.iz)(e));if("Eliminar"===t){const e=await(0,A.Jt)(a);if(e.exists()){let t;e.forEach((e=>{t=e.key})),console.log("Key:",t);const a=(0,A.KR)(xe,"GE/".concat(ye,"/Prod/").concat(me,"/").concat(o,"/").concat(t));await(0,A.TF)(a),console.log("Node deleted successfully.")}}else try{(await(0,A.Jt)(a)).exists()||(console.log("ENTRAMOS",e,o),_e(e,o))}catch(l){return console.error("Error checking value existence in the database:",l),!1}},_e=async(e,o)=>{let a=Ue(D.Pais);const l=(0,A.VC)((0,A.KR)(xe,"GE/".concat(a,"/Prod/").concat(me,"/").concat(o))).key,n="GE/".concat(a,"/Prod/").concat(me,"/").concat(o,"/").concat(l);if("Color"===o)await(0,A.hZ)((0,A.KR)(xe,n),{label:e,codigo:l}),console.log({label:e,codigo:l});else{console.log({label:e,precio:parseInt(""===ne[e]?t:ne[e]),codigo:l});const o=parseInt(""===ne[e]?t:ne[e],10);await(0,A.hZ)((0,A.KR)(xe,l),{label:e,precio:o,codigo:l})}};return(0,P.jsxs)(g.A,{component:"form",onSubmit:async o=>{o.preventDefault();const a={...D,Titulo:e,Ubicacion:W,Precio:parseFloat(t),Cantidad:parseInt(K),Detalles:U,Stock:"Nacional"===ye?I:D.Stock,Espacio:"Exterior"===ye?parseFloat(r):0,Dimension:void 0!==n?parseFloat(n):parseFloat(1.5)},l=(0,A.KR)(xe,"GE/".concat(ye,"/Prod/").concat(me)),c=(0,A.KR)(xe,"GE/Filtros/".concat(ye,"/").concat(D.Categoria,"/").concat(me));await(0,A.yo)(l,a),await(0,A.yo)(c,a);for(const e of Q)Le(e,"Color","");for(const e in ne)ne.hasOwnProperty(e)&&Le(e,"Talla","");console.log(a.Categoria,D)},sx:{mt:2,padding:2},children:[(0,P.jsx)(k.A,{texto:"Editar"}),(0,P.jsx)("div",{style:{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",marginTop:he?40:0},children:(0,P.jsx)(i.A,{variant:"contained",color:"info",onClick:()=>{Ce(!0)},children:"APLICAR DESCUENTO"})}),(0,P.jsxs)("div",{style:{margin:10},children:[(0,P.jsx)(x.A,{variant:"subtitle1",gutterBottom:!0,children:"Colores"}),Q.map(((e,o)=>(0,P.jsx)(p.A,{label:e.label,style:{margin:3},onClick:()=>We("color",e),onDelete:()=>Be(e,"color")},o))),(0,P.jsx)(h.A,{color:"primary",onClick:()=>We("color"),children:(0,P.jsx)(v.A,{})})]}),(0,P.jsxs)("div",{style:{margin:10},children:[(0,P.jsx)(x.A,{variant:"subtitle1",gutterBottom:!0,children:"Tallas"}),oe.map(((e,o)=>(0,P.jsx)(p.A,{label:"".concat(e.label," : ").concat(e.precio),style:{margin:3},onClick:()=>We("talla",e),onDelete:()=>Be(e,"talla")}))),(0,P.jsx)(h.A,{color:"primary",onClick:()=>We("talla"),children:(0,P.jsx)(v.A,{})})]}),(0,P.jsxs)(m.Ay,{container:!0,spacing:2,marginTop:he?5:0,children:[(0,P.jsx)(m.Ay,{item:!0,xs:12,children:(0,P.jsx)(s.A,{label:"Title",variant:"outlined",value:e,onChange:e=>o(e.target.value),required:!0,fullWidth:!0})}),(0,P.jsx)(m.Ay,{item:!0,xs:12,children:(0,P.jsx)(s.A,{label:"Price",variant:"outlined",type:"number",value:t,onChange:e=>l(e.target.value),required:!0,fullWidth:!0})}),"Nacional"===ye&&(0,P.jsxs)(g.A,{display:"flex",alignItems:"flex-end",marginY:1,margin:1,children:[(0,P.jsx)(s.A,{label:"Cantidad",type:"number",value:K,onChange:e=>F(e.target.value),style:{marginLeft:"8px"}}),(0,P.jsx)("div",{style:{margin:10,marginLeft:30},children:(0,P.jsx)(y.A,{control:(0,P.jsx)(j.A,{checked:I,onChange:e=>{N(e.target.checked)}}),label:"Stock"})})]}),(0,P.jsx)(m.Ay,{item:!0,xs:12,children:(0,P.jsx)(s.A,{label:"Details",variant:"outlined",multiline:!0,rows:4,value:U,onChange:e=>q(e.target.value),required:!0,fullWidth:!0})}),(0,P.jsx)("div",{style:{display:"flex",alignContent:"center",alignItems:"center"},children:(0,P.jsx)(i.A,{type:"submit",variant:"contained",color:"primary",children:H?(0,P.jsx)(C.A,{color:"warning",size:24}):"PUBLICAR"})})]}),Je&&(0,P.jsxs)("p",{children:["Entered number: ",Je]}),(0,P.jsx)(R,{isOpen:je,onClose:()=>{Ce(!1)},onConfirm:e=>{He(e),qe(e)}}),(0,P.jsx)(w.A,{open:fe,message:"Seguro que desea borrar este valor?",onClose:Oe,onConfirm:()=>{try{const e="color"===Pe;if(console.log(Se,Pe),e?X((e=>e.filter((e=>e.id!==Se.id)))):te((e=>e.filter((e=>e.id!==Se.id)))),!Se.id)return;console.log("\u2705 ".concat(e?"Color":"Talla"," '").concat(Se.label,"' eliminado de Firestore."))}catch(e){console.error("\u274c Error eliminando chip:",e)}Oe()}}),(0,P.jsx)(f.Ay,{anchor:"right",open:ke,onClose:()=>we(!1),children:(0,P.jsxs)(g.A,{sx:{width:300,padding:2},children:[(0,P.jsx)(x.A,{variant:"h6",gutterBottom:!0,children:"color"===Pe?"Nuevo Color":"Nueva Talla"}),(0,P.jsx)(s.A,{label:"color"===Pe?"Color":"Talla",value:Te,onChange:e=>Ke(e.target.value),fullWidth:!0,margin:"normal"}),"talla"===Pe&&(0,P.jsx)(s.A,{label:"Precio",type:"number",value:Fe,onChange:e=>Ie(e.target.value),fullWidth:!0,margin:"normal"}),(0,P.jsx)(i.A,{variant:"contained",color:"primary",onClick:async()=>{if(!Te)return;const e=(0,b.H9)(Ne,"productos",me);if("color"===Pe)if(Ge){X((e=>e.map((e=>e===Ge?{label:Te}:e))));(0,b.H9)((0,b.rJ)(e,"colores"),Ge.id);console.log(Te)}else{const e={label:Te};X((o=>[...o,e])),console.log(Te)}else{const o={label:Te,precio:Fe||0};if(Ge){te((e=>e.map((e=>e.id===Ge.id?{...e,label:Te,precio:Fe}:e))));(0,b.H9)((0,b.rJ)(e,"tallas"),Ge.id);console.log(o)}else te((e=>[...e,o])),console.log(o)}De(null),Ke(""),Ie(""),we(!1)},sx:{mt:2},fullWidth:!0,children:"Guardar"})]})})]})}}}]);